<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · Buffers.jl documentation</title><meta name="title" content="Guide · Buffers.jl documentation"/><meta property="og:title" content="Guide · Buffers.jl documentation"/><meta property="twitter:title" content="Guide · Buffers.jl documentation"/><meta name="description" content="Documentation for Buffers.jl documentation."/><meta property="og:description" content="Documentation for Buffers.jl documentation."/><meta property="twitter:description" content="Documentation for Buffers.jl documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Buffers.jl documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Creating-a-Buffer"><span>Creating a Buffer</span></a></li><li><a class="tocitem" href="#Creating-a-ThreadsBuffer"><span>Creating a ThreadsBuffer</span></a></li><li><a class="tocitem" href="#Allocation-with-alloc!"><span>Allocation with <code>alloc!</code></span></a></li><li><a class="tocitem" href="#Deallocation-with-drop!"><span>Deallocation with <code>drop!</code></span></a></li><li><a class="tocitem" href="#Resetting-the-Buffer-with-reset!"><span>Resetting the Buffer with <code>reset!</code></span></a></li><li><a class="tocitem" href="#Releasing-the-Buffer-with-Buffers.release!"><span>Releasing the Buffer with <code>Buffers.release!</code></span></a></li><li><a class="tocitem" href="#Reshaping-the-Buffer-with-reshape_buf!"><span>Reshaping the Buffer with <code>reshape_buf!</code></span></a></li><li><a class="tocitem" href="#Neuralyzing-Tensors-with-neuralyze"><span>Neuralyzing Tensors with <code>neuralyze</code></span></a></li><li><a class="tocitem" href="#Complete-Example"><span>Complete Example</span></a></li></ul></li><li><a class="tocitem" href="../prealloc/">Preallocation</a></li><li><a class="tocitem" href="../tensor_contractions/">Tensor contractions</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../buffers/">Buffers</a></li></ul></li><li><a class="tocitem" href="../release-notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fkfest/Buffers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fkfest/Buffers.jl/blob/main/docs/src/guide.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Buffers.jl-Usage-Guide"><a class="docs-heading-anchor" href="#Buffers.jl-Usage-Guide">Buffers.jl Usage Guide</a><a id="Buffers.jl-Usage-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Buffers.jl-Usage-Guide" title="Permalink"></a></h1><p>This guide provides detailed instructions and examples on how to use the Buffers.jl package.</p><h2 id="Creating-a-Buffer"><a class="docs-heading-anchor" href="#Creating-a-Buffer">Creating a Buffer</a><a id="Creating-a-Buffer-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-Buffer" title="Permalink"></a></h2><p>To create a buffer, you can use the <a href="../buffers/#Buffers.Buffer"><code>Buffer</code></a> type. The buffer is automatically resized based on the elements added to it.</p><pre><code class="language-julia hljs">using Buffers

buffer = Buffer{Int}() # Create a buffer of type Int</code></pre><p>You can also specify the initial size of the buffer (number of elements) to avoid reallocation.</p><pre><code class="language-julia hljs">buffer = Buffer(100) # Create a buffer with an initial size of 100 elements</code></pre><h2 id="Creating-a-ThreadsBuffer"><a class="docs-heading-anchor" href="#Creating-a-ThreadsBuffer">Creating a ThreadsBuffer</a><a id="Creating-a-ThreadsBuffer-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-ThreadsBuffer" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.ThreadsBuffer"><code>ThreadsBuffer</code></a> type extends the functionality of <code>Buffer</code> to support multi-threaded environments. It provides thread-safe operations for concurrent data manipulation.</p><pre><code class="language-julia hljs">tbuffer = ThreadsBuffer(1000) # Create a ThreadsBuffer of type Float64</code></pre><p>All operations on <code>Buffer</code> can be performed on <code>ThreadsBuffer</code> as well.</p><p>The buffers in <code>ThreadsBuffer</code> are thread-local, meaning each task uses its own buffer. This allows for concurrent allocation and deallocation of memory without causing data corruption. After the task is done, the buffer has to be released with <a href="../buffers/#Buffers.reset!-Tuple{Any}"><code>reset!</code></a> or <a href="../buffers/#Buffers.release!-Tuple{ThreadsBuffer}"><code>Buffers.release!</code></a> to be reused by another task.</p><h2 id="Allocation-with-alloc!"><a class="docs-heading-anchor" href="#Allocation-with-alloc!">Allocation with <code>alloc!</code></a><a id="Allocation-with-alloc!-1"></a><a class="docs-heading-anchor-permalink" href="#Allocation-with-alloc!" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.alloc!-Tuple{Any, Vararg{Any}}"><code>alloc!</code></a> function is used to allocate memory for tensors in the buffer.</p><pre><code class="language-julia hljs">using Buffers

buffer = Buffer(1000)
A = alloc!(buffer, 10, 10) # Allocate a 10x10 tensor
B = alloc!(buffer, 20, 5)  # Allocate a 20x5 tensor</code></pre><h2 id="Deallocation-with-drop!"><a class="docs-heading-anchor" href="#Deallocation-with-drop!">Deallocation with <code>drop!</code></a><a id="Deallocation-with-drop!-1"></a><a class="docs-heading-anchor-permalink" href="#Deallocation-with-drop!" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.drop!-Tuple{Any, Vararg{Any}}"><code>drop!</code></a> function is used to deallocate memory for tensors from the buffer.</p><pre><code class="language-julia hljs">drop!(buffer, A) # Deallocate tensor A
drop!(buffer, B) # Deallocate tensor B</code></pre><h2 id="Resetting-the-Buffer-with-reset!"><a class="docs-heading-anchor" href="#Resetting-the-Buffer-with-reset!">Resetting the Buffer with <code>reset!</code></a><a id="Resetting-the-Buffer-with-reset!-1"></a><a class="docs-heading-anchor-permalink" href="#Resetting-the-Buffer-with-reset!" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.reset!-Tuple{Any}"><code>reset!</code></a> function is used to reset the buffer to its initial state, clearing all allocated memory.</p><pre><code class="language-julia hljs">reset!(buffer) # Reset the buffer</code></pre><h2 id="Releasing-the-Buffer-with-Buffers.release!"><a class="docs-heading-anchor" href="#Releasing-the-Buffer-with-Buffers.release!">Releasing the Buffer with <code>Buffers.release!</code></a><a id="Releasing-the-Buffer-with-Buffers.release!-1"></a><a class="docs-heading-anchor-permalink" href="#Releasing-the-Buffer-with-Buffers.release!" title="Permalink"></a></h2><p>For <a href="../buffers/#Buffers.ThreadsBuffer"><code>ThreadsBuffer</code></a>, the <a href="../buffers/#Buffers.release!-Tuple{ThreadsBuffer}"><code>Buffers.release!</code></a> function is used to release the buffer of the current thread. Note: the <a href="../buffers/#Buffers.reset!-Tuple{Any}"><code>reset!</code></a> function includes a call to <code>release!</code>.</p><pre><code class="language-julia hljs">tbuffer = ThreadsBuffer(1000)
Threads.@threads for i in 1:4
    A = alloc!(tbuffer, 10, 10)
    drop!(tbuffer, A)
    Buffers.release!(tbuffer) # Release the buffer for the current thread
end</code></pre><h2 id="Reshaping-the-Buffer-with-reshape_buf!"><a class="docs-heading-anchor" href="#Reshaping-the-Buffer-with-reshape_buf!">Reshaping the Buffer with <code>reshape_buf!</code></a><a id="Reshaping-the-Buffer-with-reshape_buf!-1"></a><a class="docs-heading-anchor-permalink" href="#Reshaping-the-Buffer-with-reshape_buf!" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.reshape_buf!-Tuple{Any, Vararg{Any}}"><code>reshape_buf!</code></a> function is used to reshape the buffer to a new set of dimensions without copying the data or explicitly allocating a tensor on the buffer.</p><pre><code class="language-julia hljs">buffer = Buffer(1000)
A = reshape_buf!(buffer, 10, 10) # Reshape buffer to a 10x10 tensor
B = reshape_buf!(buffer, 20, 5, offset=100) # Reshape buffer to a 20x5 tensor starting at offset 100</code></pre><h2 id="Neuralyzing-Tensors-with-neuralyze"><a class="docs-heading-anchor" href="#Neuralyzing-Tensors-with-neuralyze">Neuralyzing Tensors with <code>neuralyze</code></a><a id="Neuralyzing-Tensors-with-neuralyze-1"></a><a class="docs-heading-anchor-permalink" href="#Neuralyzing-Tensors-with-neuralyze" title="Permalink"></a></h2><p>The <a href="../buffers/#Buffers.neuralyze-Tuple{AbstractArray}"><code>neuralyze</code></a> function is used to wipe the memory about the origin of a tensor. This can be helpful when you need to bypass Julia&#39;s aliasing checks or ensure that a tensor is treated as an independent array for example in a C call.</p><pre><code class="language-julia hljs">A = alloc!(buffer, 10, 10)
An = neuralyze(A) # Neuralyze tensor A</code></pre><h2 id="Complete-Example"><a class="docs-heading-anchor" href="#Complete-Example">Complete Example</a><a id="Complete-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Example" title="Permalink"></a></h2><p>Here is a complete example demonstrating the usage of <a href="../buffers/#Buffers.alloc!-Tuple{Any, Vararg{Any}}"><code>alloc!</code></a>, <a href="../buffers/#Buffers.drop!-Tuple{Any, Vararg{Any}}"><code>drop!</code></a>, <a href="../buffers/#Buffers.reset!-Tuple{Any}"><code>reset!</code></a>, and <a href="../buffers/#Buffers.reshape_buf!-Tuple{Any, Vararg{Any}}"><code>reshape_buf!</code></a> functions:</p><pre><code class="language-julia hljs">using Buffers

# Create a buffer
buffer = Buffer(1000)

# Allocate tensors
A = alloc!(buffer, 10, 10)
B = alloc!(buffer, 20, 5)

# Perform operations on tensors
rand!(A)
rand!(B)

# Deallocate tensors
drop!(buffer, A)
drop!(buffer, B)

# Create a ThreadsBuffer
tbuffer = ThreadsBuffer(1000)

# Use ThreadsBuffer in a threaded loop
@sync for i in 1:4
  Threads.@spawn begin
    A = alloc!(tbuffer, 10, 10)
    B = alloc!(tbuffer, 20, 5)
    drop!(tbuffer, A, B)
    reset!(tbuffer) # Release the buffer for the current thread
  end
end

# Reshape the buffer
C = reshape_buf!(buffer, 10, 10)
D = reshape_buf!(buffer, 20, 5, offset=100)</code></pre><p>For more detailed information, please refer to the other sections of the documentation.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../prealloc/">Preallocation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 9 December 2024 14:19">Monday 9 December 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
